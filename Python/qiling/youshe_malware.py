# x86木马dll分析

from qiling import Qiling
from qiling.const import QL_ARCH, QL_OS, QL_VERBOSE
from unicorn.x86_const import *
from colorama import Fore,Back,Style,init



init(wrap=True, autoreset=True)
ql = Qiling([r'rootfs/x86_windows/a690000.dll'], rootfs=r"rootfs/x86_windows",verbose=QL_VERBOSE.DEFAULT)
# TODO
# 为什么map_anywhere会返回0呢
arg1 = ql.mem.map_anywhere(4096)
assert(arg1)
print(Fore.GREEN+str(hex(arg1)))
ql.mem.write(arg1,'qilingtest'.encode('utf-16-le'))
ql.debugger = True
ql.arch.regs.write('ecx',arg1)
ql.run(begin=0x10001300,end=0x1000199B)
